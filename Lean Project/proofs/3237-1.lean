import Init.WF
import Init.WFTactics
import Init.Data.Nat.Basic
import Init.Data.Nat.Div

open Nat


example (x n p : Nat) (h₁ : x < n*p) : (n * p - (x + 1)) / n = p - ((x / n) + 1) := by
  have hn : 0 < n := by
    contrapose! h₁
    simp [h₁]

  have h₂ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₉ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₁₀ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₁₁ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₁₂ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₁₃ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₁₄ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₁₅ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₁₆ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₁₇ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₁₈ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₁₉ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₂₀ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₂₁ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₂₂ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₂₃ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₂₄ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₂₅ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₂₆ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₂₇ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₂₈ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₂₉ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃₀ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃₁ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃₂ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃₃ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃₄ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃₅ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃₆ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃₇ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃₈ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₃₉ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄₀ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄₁ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄₂ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄₃ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄₄ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄₅ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄₆ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄₇ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄₈ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₄₉ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅₀ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅₁ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅₂ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅₃ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅₄ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅₅ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅₆ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅₇ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅₈ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₅₉ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆₀ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆₁ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆₂ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆₃ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆₄ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆₅ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆₆ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆₇ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆₈ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₆₉ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇₀ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇₁ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇₂ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇₃ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇₄ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇₅ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇₆ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇₇ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇₈ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₇₉ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈₀ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈₁ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈₂ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈₃ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈₄ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈₅ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈₆ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈₇ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈₈ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₈₉ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₉₀ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₉₁ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₉₂ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₉₃ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₉₄ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₉₅ : (n * p - (x + 1)) / n = (n * p - (x + 1)) / n := by rfl

  have h₉₆ : (n * p - (x + 1)) / n = (n * p - (

/- ACTUAL PROOF OF Nat.mul_sub_div -/

example (x n p : Nat) (h₁ : x < n*p) : (n * p - (x + 1)) / n = p - ((x / n) + 1) := by
  have npos : 0 < n := (eq_zero_or_pos _).resolve_left fun n0 => by
    rw [n0, Nat.zero_mul] at h₁; exact not_lt_zero _ h₁
  apply Nat.div_eq_of_lt_le
  focus
    rw [Nat.mul_sub_right_distrib, Nat.mul_comm]
    exact Nat.sub_le_sub_left ((div_lt_iff_lt_mul npos).1 (lt_succ_self _)) _
  focus
    show succ (pred (n * p - x)) ≤ (succ (pred (p - x / n))) * n
    rw [succ_pred_eq_of_pos (Nat.sub_pos_of_lt h₁),
      fun h => succ_pred_eq_of_pos (Nat.sub_pos_of_lt h)] -- TODO: why is the function needed?
    focus
      rw [Nat.mul_sub_right_distrib, Nat.mul_comm]
      exact Nat.sub_le_sub_left (div_mul_le_self ..) _
    focus
      rwa [div_lt_iff_lt_mul npos, Nat.mul_comm]